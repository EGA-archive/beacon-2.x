<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1.0, width=device-width, shrink-to-fit=no"/>
    <title>{{ conf.beacon_name }}</title>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css"
	  integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg"
	  crossorigin="anonymous" />

    <!-- Stylesheets -->
    <link rel="stylesheet" href="//necolas.github.io/normalize.css/latest/normalize.css">
    <link rel="stylesheet" href="{{ static('css_main/style.css') }}">  <!-- USING TEST STYLE SHEET -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/cupertino/jquery-ui.css" />
    <!-- End Stylesheets -->

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet" media="all">  <!-- font-family: 'IBM Plex Sans', sans-serif; -->
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet" media="all">  <!-- font-family: 'IBM Plex Mono', monospace; -->

	  <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet"> <!-- font-family: 'Open Sans', sans-serif; -->
	  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">  <!-- font-family: 'Roboto Mono', monospace; -->
    <!-- End Fonts -->

    <!-- Plugins -->
    <link rel="stylesheet" href="{{ static('css_main/bootstrap-multiselect.css') }}" type="text/css" media="screen" />
    <!-- End Plugins -->

    <link rel="icon" href="//beacon-project.io/assets/img/site-specific/site-logo-topleft.png">

  </head>

  <body>
    <header>
      <div id="header-logo">
        <img src="//beacon-project.io/assets/img/site-specific/site-logo-topleft.png" alt="Beacon Logo">
        <a href="{{ url('main') }}" class="title">Beacon Test Instance</a>
        <a href="{{ url('datasets') }}" class="link {% if datasets_page %}active{% endif %}">Datasets</a>
        <a href="{{ url('filtering_terms') }}" class="link {% if filtering_terms_page %}active{% endif %}">Filtering Terms</a>
      </div>
      <div id="header-login">
        {% if session.user %}
          <a href="{{ url('logout') }}?next={{ request.path }}" class="login-button">Logout</a>
        {% else %} 
          <a href="{{ url('login') }}?next={{ request.path }}" class="login-button">Login</a>
        {% endif %}
      </div>
    </header>
    <main>
      <form action="{{ url('main') }}" method="POST">
        <section id="target-selection">
            <input id="target-instance" type="hidden" name="targetInstance" value="">

            <div class="target-icon {% if targetInstance == 'sample' %}active{% endif %}" data-target="sample" title="Biosample"><i class="fas fa-vial"></i></div>
            <div class="target-icon {% if targetInstance == 'individual' %}active{% endif %}" data-target="individual" title="Individual"><i class="fas fa-male"></i></div>
            <div class="target-icon {% if targetInstance == 'variant' %}active{% endif %}" data-target="variant" title="Variant"><i class="far fa-dot-circle"></i></div>

            <!-- Empty divs to show more targets are expected in the future -->
            <div class="target-icon empty"></div>
            <div class="target-icon empty"></div>
            <div class="target-icon empty"></div>
            <div class="target-icon empty"></div>
            <div class="target-icon empty"></div>
        </section>
        <section id="result-selection-all" class="result-selection {% if (targetInstance == resultOption) and not targetId %}active{% endif %}">
          <h1>Search all</h1>
          <input type="radio" name="resultOption" class="result-option" id="result-option-all" value="all" style="display: none;" {% if (targetInstance == resultOption) and not targetId %}checked{% endif %}>
          <p>or</p>
        </section>
        <section id="result-selection-complex" class="result-selection {% if targetId %}active{% endif %}">
          <h1>Search by ID</h1>
          <input type="text" id="targetId" name="targetId" value="{% if targetId %}{{ targetId }}{% endif %}">
          <div class="options-wrapper {% if targetInstance == 'individual' %}active{% endif %}" id="individual-options">
            <div><input id="individual-individual" type="radio" name="resultOption" class="result-option" value="individual" {% if targetId and resultOption == 'individual' and targetInstance == 'individual' %}checked{% endif %}> <label for="individual-individual">Show individual</label></div>
            <div><input id="individual-sample" type="radio" name="resultOption" class="result-option" value="sample" {% if targetId and resultOption == 'sample' and targetInstance == 'individual' %}checked{% endif %}> <label for="individual-sample">Show samples from individual</label></div>
            <div><input id="individual-variant" type="radio" name="resultOption" class="result-option" value="variant" {% if targetId and resultOption == 'variant' and targetInstance == 'individual' %}checked{% endif %}> <label for="individual-variant">Show variants from individual</label></div>
          </div>
          <div class="options-wrapper {% if targetInstance == 'sample' %}active{% endif %}" id="sample-options">
            <div><input id="sample-sample" type="radio" name="resultOption" class="result-option" value="sample" {% if targetId and resultOption == 'sample' and targetInstance == 'sample' %}checked{% endif %}> <label for="sample-sample">Show sample</label></div>
            <div><input id="sample-individual"  type="radio" name="resultOption" class="result-option" value="individual" {% if targetId and resultOption == 'individual' and targetInstance == 'sample' %}checked{% endif %}> <label for="sample-individual">Show individual</label></div>
            <div><input id="sample-variant" type="radio" name="resultOption" class="result-option" value="variant" {% if targetId and resultOption == 'variant' and targetInstance == 'sample' %}checked{% endif %}> <label for="sample-variant">Show variants in sample</label></div> 
          </div>
          <div class="options-wrapper {% if targetInstance == 'variant' %}active{% endif %}" id="variant-options">
            <div><input id="variant-variant" type="radio" name="resultOption" class="result-option" value="variant" {% if targetId and resultOption == 'variant' and targetInstance == 'variant' %}checked{% endif %}> <label for="variant-variant">Show variant</label></div>
            <div><input id="variant-individual" type="radio" name="resultOption" class="result-option" value="individual" {% if targetId and resultOption == 'individual' and targetInstance == 'variant' %}checked{% endif %}> <label for="variant-individual">Show individuals with variant</label></div>
            <div><input id="variant-sample" type="radio" name="resultOption" class="result-option" value="sample" {% if targetId and resultOption == 'sample' and targetInstance == 'variant' %}checked{% endif %}> <label for="variant-sample">Show samples with variant</label></div>
          </div>
        </section>
        <section id="filters">
          <h1>Filters</h1>
          <div id="variant-title">
            <p>Variant</p>
            <span class="variant-button {% if variantOption == 'basic' %}active{% endif %}" id="variant-basic-button">basic</span><span class="variant-button {% if variantOption == 'advanced' %}active{% endif %}" id="variant-advanced-button">advanced</span>
            <input type="hidden" name="variantOption" id="variant-option" value="{% if variantOption %}{{ variantOption }}{% else %}basic{% endif %}">
          </div>
          <div id="variant-basic" class="variant-option {% if variantOption == 'basic' %}active{% endif %}">
            <select name="assemblyIdBasic">
              <option value="">Assembly</option>
              <option value="grch37.p1" {% if variantOption == 'basic' and qparams and qparams.assemblyId and qparams.assemblyId == 'grch37.p1' %}selected{% endif %}>grch37.p1</option>
            </select>
            <input type="text" name="variantQuery" pattern="^\s*(X|Y|MT|[1-9]|1[0-9]|2[0-2])\s*\:\s*(\d+)\s+([ATCGN]+)\s*\>\s*([ATCGN]+)$" placeholder="chr : pos ref > alt" title="chromosome : position reference > alternate" value="{% if variantOption == 'basic' and variantQuery %}{{ variantQuery }}{% endif %}">
          </div>
          <div id="variant-advanced" class="variant-option {% if variantOption == 'advanced' %}active{% endif %}">
            <select name="assemblyIdAdvanced">
              <option value="">Assembly</option>
              <option value="grch37.p1" {% if variantOption == 'advanced' and qparams and qparams.assemblyId and qparams.assemblyId == 'grch37.p1' %}selected{% endif %}>grch37.p1</option>
            </select>
            <select title="Chromosome" name="chromosome">
              <option title="None selected" value="">Chr</option>
              {% for i in range(1,23) %}
                <option title="Chromosome {{i}}" value="{{i}}" {% if variantOption == 'advanced' and qparams and qparams.referenceName and qparams.referenceName == '{{i}}' %}selected{% endif %}> {{i}} </option>
              {% endfor %}
              <option title="Chromosome X" value="X" {% if variantOption == 'advanced' and qparams and qparams.referenceName and qparams.referenceName == 'X' %}selected{% endif %}> X </option>
              <option title="Chromosome Y" value="Y" {% if variantOption == 'advanced' and qparams and qparams.referenceName and qparams.referenceName == 'Y' %}selected{% endif %}> Y </option>
              <option title="Chromosome MT" value="MT" {% if variantOption == 'advanced' and qparams and qparams.referenceName and qparams.referenceName == 'MT' %}selected{% endif %}> MT </option>
            </select>
            <div id="variant-pos-selection">
              <input id="variant-exact" type="radio" name="variantPosOption" value="variant-pos-exact" {% if variantPosOption == 'variant-pos-exact' %}checked{% endif %}> <label for="variant-exact">Exact</label>
              <input id="variant-range" type="radio" name="variantPosOption" value="variant-pos-range" {% if variantPosOption == 'variant-pos-range' %}checked{% endif %}> <label for="variant-range">Range</label>
            </div>
            <div id="variant-pos-exact" class="variant-pos-option {% if variantPosOption == 'variant-pos-exact' %}active{% endif %}">
              <input type="number" name="start" min="0" value="{% if variantOption == 'advanced' and variantPosOption == 'variant-pos-exact' and qparams %}{{qparams.start[0]}}{% endif %}" placeholder="start">
              <input type="number" name="end" min="0" value="{% if variantOption == 'advanced' and variantPosOption == 'variant-pos-exact' and qparams %}{{qparams.end[0]}}{% endif %}" placeholder="end">
            </div>
            <div id="variant-pos-range" class="variant-pos-option {% if variantPosOption == 'variant-pos-range' %}active{% endif %}">
              <input type="number" name="startMin" min="0" value="{% if variantOption == 'advanced' and variantPosOption == 'variant-pos-range' and qparams %}{{qparams.start[0]}}{% endif %}" placeholder="min start">
              <input type="number" name="startMax" min="0" value="{% if variantOption == 'advanced' and variantPosOption == 'variant-pos-range' and qparams %}{{qparams.start[1]}}{% endif %}" placeholder="max start">
              <input type="number" name="endMin" min="0" value="{% if variantOption == 'advanced' and variantPosOption == 'variant-pos-range' and qparams %}{{qparams.end[0]}}{% endif %}" placeholder="min end">
              <input type="number" name="endMax" min="0" value="{% if variantOption == 'advanced' and variantPosOption == 'variant-pos-range' and qparams %}{{qparams.end[1]}}{% endif %}" placeholder="max end">
            </div>
            <input class="variant-bases-input" type="text" name="reference" pattern="^([ACGT]+)$" title="A, C, G or T" value="{% if variantOption == 'advanced' and variantPosOption == 'variant-pos-range' and qparams %}{{qparams.referenceBases}}{% endif %}" placeholder="reference">
            <input class="variant-bases-input" type="text" name="alternate" pattern="^([ACGT]+)$" title="A, C, G or T" value="{% if variantOption == 'advanced' and variantPosOption == 'variant-pos-range' and qparams %}{{qparams.alternateBases}}{% endif %}" placeholder="alternate">  

          </div>
          <p>Datasets</p>
          <select id="example-getting-started" multiple="multiple" name="datasets">
            {% for dataset in allDatasets %}
              {% if dataset in allowedDatasets %}
              <option value="{{dataset}}" {% if datasets and dataset in datasets %}selected{% endif %}>{{dataset}}</option>
              {% else %}
              <option value="{{dataset}}" disabled>{{dataset}}</option>
              {% endif %}
            {% endfor %}
        </select>
          
          <p>Ontologies</p>
          <input type="text" value="" id="ontologies-filter">
          <input type="hidden" id="filters-hidden" name="filters" value="{% if filters %}{{filters}}{% endif %}">
          <div id="filters-tags" class="{% if filters %}active{% endif %}">
            {% if filters %}
            {% for filter in filters.split(",") %}
            <span data-ontology="{{filter}}" >{{filter}}<i class='fas fa-times'></i></span>
            {% endfor %}
            {% endif %}
          </div>
        </section>
        <section id="search-button">
          <input type="submit" value="Search"/>
          
        </section>  
      </form>
      <div id="main">
        {% if records and not homepage %}
            {% if resultOption == "individual" %}
              {% include "result-individual.html" %}
            {% elif resultOption == "sample" %}
              {% include "result-sample.html" %}
            {% elif resultOption == "variant" %}
              {% include "result-variant.html" %}
          {% endif %}
        {% elif not records and not homepage and not error%}
          <p class="no-results">No results. Try again, please.</p>
        {% elif error %}
          <p class="no-results"> <i class="fas fa-exclamation-triangle"></i><span>Error:</span> {{error}}</p>
        {% else %}
          {% include "result-homepage.html" %}
        {% endif %}
      </div>
    </main>
    <footer>
      <p>&copy; Copyright 2020</p>
    </footer>

    <!-- JQuery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="{{ static('js/jquery.min.js') }}">\x3C/script>')</script>
    <script src="//code.jquery.com/ui/1.12.1/jquery-ui.min.js" crossorigin="anonymous"></script>
    <!-- End Jquery -->

    <!-- Bootstrap Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- Plugins -->
    <script type="text/javascript" src="{{ static('js/bootstrap-multiselect.js') }}"></script>
    <!-- End Plugins -->

    <!-- Custom -->
    <script src="{{ static('js/main.js') }}"></script>
    <script src="{{ static('js/ontologies_autocomplete.js') }}"></script>
    <!-- End Custom -->


  </body>
</html>
